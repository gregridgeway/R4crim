{
  "hash": "aafe5c23be7c4599210efaf8cd679ff5",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Working with National Crime Victimization Survey Data\"\nauthor:\n- affiliation: University of Pennsylvania\n  email: gridge@upenn.edu\n  name: Greg Ridgeway\n- affiliation: University of Pennsylvania\n  email: moyruth@upenn.edu\n  name: Ruth Moyer\n- affiliation: University of Pennsylvania\n  email: gohl@upenn.edu\n  name: Li Sian Goh\ndate: \"August 14, 2025\"\nformat:\n  html:\n    theme: \n      dark: darkly\n      light: default\n    toc: true\n    html-math-method: mathjax\n  pdf:\n    toc: true\n    prefer-html: true\nnumber-sections: true\neditor_options: \n  chunk_output_type: console\nbibliography: G:/My Drive/docs/Greg/articles/mybib.bib\n---\n\n\n\n\n\n<!-- In terminal -->\n<!-- quarto render 04_Working_with_NCVS_data.qmd -->\n\n<!-- git commit 04-* -m \"commit message\" -->\n<!-- git status -->\n<!-- git push -->\n\n\n\n<!-- A function for automating the numbering and wording of the exercise questions -->\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n\n\n\n# Introduction\n\nThrough our work with NIBRS, we have already discussed reported crime. Nonetheless, not all crimes are reported to the police. Each year, under the guidance of the Bureau of Justice Statistics, the U.S. Census Bureau conducts the National Crime Victimization Survey (NCVS), a source of self-reported victimization data. The Census Bureau interviews a sample of people 12 years old or older about the number and characteristics of crime victimizations they experienced during the prior 6 months. \n\nIn 2023 226,480 people in 142,028 households participated. The survey had a 63\\% response rate for households and 82\\% response rate for individuals. Households remain in the sample for $3\\frac{1}{2}$ years completing interviews every 6 months, in person or by phone, for a total of seven interviews. The survey cost \\$62M annually and required roughly 125,000 hours of uncompensated respondent time.\n\nThe NCVS contains information about nonfatal personal crimes, such as rape and robbery, as well as property crimes, such as burglary. Additional information about the NCVS can be found at the [BJS website](https://bjs.ojp.gov/data-collection/ncvs). To give a sense of the type of data that the NCVS contains, refer to the [Official 2023 BJS Crime Victimization report](https://bjs.ojp.gov/library/publications/criminal-victimization-2023).\n\n# Acquiring the NCVS data\n\nThe University of Michigan consolidates the NCVS data into a format that is easily accessible in R. We will be using data collected in 2022 and 2023 to assemble a dataset that covers victimizations occurring in 2022. Since respondents are asked about crime in the previous six months, respondents completing surveys in May 2023 will still be reporting about crimes in December 2022.\n\nFirst, we will download the NCVS 2022 data, [ICPSR 38603](https://www.icpsr.umich.edu/web/NACJD/studies/38603). Click on Download, select R, save the resulting file (called something like ICPSR_38603-V1.zip), extract the contents of the zipped file to a convenient folder, and give it a more understandable folder name, like NCVS2022. Repeat the process for downloading the NCVS 2023 data, [ICPSR 38962](https://www.icpsr.umich.edu/web/NACJD/studies/38962). New NCVS data tends to appear in mid-September. Typically we need to wait about nine months to get the results from the previous year.\n\nAfter unzipping the NCVS files, you will find subfolders called DS0001, DS0002, DS0003, DS0004, and DS0005. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlist.files(\"NCVS2022/\",recursive = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"38603-descriptioncitation.html\"      \n [2] \"38603-manifest.txt\"                  \n [3] \"38603-related_literature.txt\"        \n [4] \"38603-User_guide.pdf\"                \n [5] \"DS0001/38603-0001-Codebook-ICPSR.pdf\"\n [6] \"DS0001/38603-0001-Data.rda\"          \n [7] \"DS0002/38603-0002-Codebook-ICPSR.pdf\"\n [8] \"DS0002/38603-0002-Data.rda\"          \n [9] \"DS0003/38603-0003-Codebook-ICPSR.pdf\"\n[10] \"DS0003/38603-0003-Data.rda\"          \n[11] \"DS0004/38603-0004-Codebook-ICPSR.pdf\"\n[12] \"DS0004/38603-0004-Data.rda\"          \n[13] \"DS0005/38603-0005-Codebook-ICPSR.pdf\"\n[14] \"DS0005/38603-0005-Data.rda\"          \n[15] \"factor_to_numeric_icpsr.R\"           \n[16] \"series-95-related_literature.txt\"    \n[17] \"TermsOfUse.html\"                     \n```\n\n\n:::\n\n```{.r .cell-code}\nlist.files(\"NCVS2023/\",recursive = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"38962-descriptioncitation.html\"       \n [2] \"38962-manifest.txt\"                   \n [3] \"38962-related_literature.txt\"         \n [4] \"38962-User_guide.pdf\"                 \n [5] \"DS0001/38962-0001-Codebook-ICPSR.epub\"\n [6] \"DS0001/38962-0001-Codebook-ICPSR.pdf\" \n [7] \"DS0001/38962-0001-Data.rda\"           \n [8] \"DS0002/38962-0002-Codebook-ICPSR.epub\"\n [9] \"DS0002/38962-0002-Codebook-ICPSR.pdf\" \n[10] \"DS0002/38962-0002-Data.rda\"           \n[11] \"DS0003/38962-0003-Codebook-ICPSR.epub\"\n[12] \"DS0003/38962-0003-Codebook-ICPSR.pdf\" \n[13] \"DS0003/38962-0003-Data.rda\"           \n[14] \"DS0004/38962-0004-Codebook-ICPSR.epub\"\n[15] \"DS0004/38962-0004-Codebook-ICPSR.pdf\" \n[16] \"DS0004/38962-0004-Data.rda\"           \n[17] \"DS0005/38962-0005-Codebook-ICPSR.epub\"\n[18] \"DS0005/38962-0005-Codebook-ICPSR.pdf\" \n[19] \"DS0005/38962-0005-Data.rda\"           \n[20] \"factor_to_numeric_icpsr.R\"            \n[21] \"series-95-related_literature.txt\"     \n[22] \"TermsOfUse.html\"                      \n```\n\n\n:::\n:::\n\n\n\nInside each of these subfolders you see an R data file with the extension .rda. We will spend most of our attention on the contents of the DS0005 folder, which contains the \"incident-level extract file.\" In each folder you will also find codebooks in pdf (and epub) format. The codebook is as important as it is tedious for understanding what is stored in the NCVS data. You should become familiar with the codebooks as soon as you can.\n\nLet's start loading these datasets. We will skip the DS0001 subfolder, which contains basic survey information on the targeted addresses. The DS0002 folder contains data on the households included in the survey.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nload(\"NCVS2022/DS0002/38603-0002-Data.rda\")\nload(\"NCVS2023/DS0002/38962-0002-Data.rda\")\n\n# and let's give them nicer names\ndataHH22 <- da38603.0002\ndataHH23 <- da38962.0002\n```\n:::\n\n\n\nTake a peek at the first couple of rows\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(tidyr)\n\ndataHH22 |>\n  head() |>\n  select(V2001, YEARQ, IDHH, V2003, V2014, V2016, V2018, V2020,\n         V2030, V2031, V2032, V2034, V2036, V2038, V2040A, V2127B, V2129) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                 V2001  YEARQ                      IDHH                   V2003\n1 (2) Household record 2022.1 1809000258358302568236125 (221) 2022, 1st quarter\n2 (2) Household record 2022.1 1809000258380931568236135 (221) 2022, 1st quarter\n3 (2) Household record 2022.1 1809000258543680568236125 (221) 2022, 1st quarter\n4 (2) Household record 2022.1 1809000284326166568236135 (221) 2022, 1st quarter\n5 (2) Household record 2022.1 1809000284384631568236124 (221) 2022, 1st quarter\n6 (2) Household record 2022.1 1809000284459399568236114 (221) 2022, 1st quarter\n                 V2014     V2016                V2018               V2020\n1                 <NA> (1) Urban                 <NA> (01) House/apt/flat\n2 (1) Owned/being bght (1) Urban                 <NA> (01) House/apt/flat\n3 (1) Owned/being bght (1) Urban                 <NA> (01) House/apt/flat\n4 (1) Owned/being bght (1) Urban                 <NA> (01) House/apt/flat\n5 (1) Owned/being bght (2) Rural (2) Less than $1,000 (01) House/apt/flat\n6 (1) Owned/being bght (2) Rural (2) Less than $1,000 (01) House/apt/flat\n                   V2030           V2031                 V2032        V2034\n1 (218) Type A - Refused (01) White only                  <NA>         <NA>\n2 (300) Interviewed hhld            <NA> (11) Reference person  (2) Widowed\n3 (300) Interviewed hhld            <NA> (11) Reference person (3) Divorced\n4 (300) Interviewed hhld            <NA> (11) Reference person (3) Divorced\n5 (300) Interviewed hhld            <NA> (11) Reference person  (1) Married\n6 (300) Interviewed hhld            <NA> (11) Reference person  (2) Widowed\n       V2036                 V2038          V2040A    V2127B\n1       <NA>                  <NA>            <NA> (3) South\n2   (1) Male  (42) Bachelor degree (01) White only (3) South\n3   (1) Male  (42) Bachelor degree (01) White only (3) South\n4 (2) Female    (43) Master degree (01) White only (3) South\n5 (2) Female (28) High school grad (01) White only (3) South\n6 (2) Female (28) High school grad (01) White only (3) South\n                V2129\n1 (2) (S)MSA not city\n2      (3) Not (S)MSA\n3  (1) City of (S)MSA\n4 (2) (S)MSA not city\n5      (3) Not (S)MSA\n6 (2) (S)MSA not city\n```\n\n\n:::\n:::\n\n\n\nThe 2022 household dataset has 448 columns. Instead of printing out all of them, here I just picked out 17 columns here. First off you can see that the column names are generally not helpful. That is where the codebook comes in handy. The codebook tells you what each variable means.\n\nSomewhat hidden is a table linking column names to English explanations of what is in those columns. You can get to it by extracting the data frame's \"attributes\" with `attr()`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvarsHH <- dataHH22 |>\n   attr(\"variable.labels\") |>\n   data.frame() |>\n   tibble::rownames_to_column() |>\n   setNames(c(\"varname\",\"details\")) |>\n   filter(!grepl(\"^HHREP\", varname)) # exclude rows that start with HHREP\n```\n:::\n\n\n\nNow `varsHH` has two columns, the first with the column names and the second with the details. Let's pull up the 17 columns listed before.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvarsHH |>\n   filter(varname %in% c(\"V2001\",\"YEARQ\",\"IDHH\",\"V2003\",\"V2014\",\"V2016\",\n                         \"V2018\",\"V2020\",\"V2030\",\"V2031\",\"V2032\",\"V2034\",\"V2036\",\n                         \"V2038\",\"V2040A\",\"V2127B\",\"V2129\")) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   varname                                                 details\n1    V2001                                   HOUSEHOLD RECORD TYPE\n2    YEARQ                  YEAR AND QUARTER OF INTERVIEW (YYYY.Q)\n3     IDHH                                  NCVS ID FOR HOUSEHOLDS\n4    V2003                  YEAR AND QUARTER IDENTIFICATION NUMBER\n5    V2014                                       TENURE (ORIGINAL)\n6    V2016                                     LAND USE (ORIGINAL)\n7    V2018                                   FARM SALES (ORIGINAL)\n8    V2020                      TYPE OF LIVING QUARTERS (ORIGINAL)\n9    V2030                                 REASON FOR NONINTERVIEW\n10   V2031                   RACE OF HH HEAD (TYPE A NONINTERVIEW)\n11   V2032                 PRINCIPAL PERSON RELATION TO REF PERSON\n12   V2034                  PRINCIPAL PERSON MARITAL STATUS (CURR)\n13   V2036                        PRINCIPAL PERSON SEX (ALLOCATED)\n14   V2038                 PRINCIPAL PERSON EDUCATIONAL ATTAINMENT\n15  V2040A            PRINCIPAL PERSON RACE RECODE (START 2003 Q1)\n16  V2127B REGION - 1990, 2000, 2010 SAMPLE DESIGN (START 1995 Q3)\n17   V2129                                              MSA STATUS\n```\n\n\n:::\n:::\n\n\n\nThese are much more intelligible descriptions. \"(S)MSA\" stands for the Standard Metropolitan Statistical Areas, an outdated term. Today we call them simply MSAs. Minimum population has to be 50,000, but there is movement toward redefining as 100,000.\n\nNote the first household record has `IDHH` equal to 1809000258543680568236125. We can load the respondent \"person file\" to see who in this household responded.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# loading person-level data\nload(\"NCVS2022/DS0003/38603-0003-Data.rda\")\nload(\"NCVS2023/DS0003/38962-0003-Data.rda\")\ndataPers22 <- da38603.0003\ndataPers23 <- da38962.0003\n\n# lookup respondents from this household\ndataPers22 |>\n  filter(IDHH==\"1809000258543680568236125\") |>\n  select(!starts_with(\"PERREP\"))  # drop all the PERREP weight columns\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              V3001  YEARQ                      IDHH\n1 (3) Person record 2022.1 1809000258543680568236125\n2 (3) Person record 2022.3 1809000258543680568236125\n                        IDPER V3002                   V3003 V3004\n1 180900025854368056823612501     3 (221) 2022, 1st quarter    18\n2 180900025854368056823612501     3 (223) 2022, 3rd quarter    18\n                 V3005 V3006 V3008 V3009 V3010              V3011\n1 09000258543680568236     1    25     1     1  (1) Personal/self\n2 09000258543680568236     1    25     1     1 (2) Telephone/self\n                  V3012 V3013 V3014        V3015        V3016    V3017    V3018\n1 (11) Reference person    62    62 (3) Divorced (3) Divorced (1) Male (1) Male\n2 (11) Reference person    63    63 (3) Divorced (3) Divorced (1) Male (1) Male\n   V3019                V3020          V3023A  V3024 V3024A         V3025 V3026\n1 (2) No (42) Bachelor degree (01) White only (2) No (2) No (02) February    12\n2 (2) No (42) Bachelor degree (01) White only (2) No (2) No   (08) August    31\n  V3027 V3031 V3032 V3033  V3034 V3035  V3040 V3041  V3042 V3043  V3044 V3045\n1  2022    NA    23    NA (2) No    NA (2) No    NA (2) No    NA (2) No    NA\n2  2022    NA    24    NA (2) No    NA (2) No    NA (2) No    NA (2) No    NA\n   V3046 V3047  V3048 V3049 V3050 V3051 V3052 V3053  V3054 V3055 V3056 V3057\n1 (2) No    NA (2) No  <NA>  <NA>  <NA>  <NA>    NA (2) No  <NA>  <NA>  <NA>\n2 (2) No    NA (2) No  <NA>  <NA>  <NA>  <NA>    NA (2) No  <NA>  <NA>  <NA>\n  V3058 V3059                V3060   V3061   V3062  V3063  V3064  V3065  V3066\n1  <NA>    NA (1) At least 1 entry  (0) No (1) Yes (0) No (0) No (0) No (0) No\n2  <NA>    NA (1) At least 1 entry (1) Yes  (0) No (0) No (0) No (0) No (0) No\n   V3067  V3068               V3069 V3070 V3_V4526H3A V3_V4526H3B V3_V4526H5\n1 (0) No (0) No (0) No out of range  <NA>      (2) No      (2) No     (2) No\n2 (0) No (0) No (0) No out of range  <NA>      (2) No      (2) No     (2) No\n  V3_V4526H4 V3_V4526H6 V3_V4526H7                              V3083\n1     (2) No     (2) No     (2) No (1) Yes, born in the United States\n2     (2) No     (2) No     (2) No (1) Yes, born in the United States\n                                      V3084    V3085    V3086\n1 (2) Straight, that is, not lesbian or gay (1) Male (1) Male\n2 (2) Straight, that is, not lesbian or gay (1) Male (1) Male\n                             V3087 V3088 V3089 V3090 V3091 V3092 V3093 V3094\n1 (1) Never served in the military  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>\n2 (1) Never served in the military  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>  <NA>\n  V3097A V3098   V3071 V3072 V3073               V3074                V3075\n1   <NA>  <NA> (1) Yes  <NA>  <NA> (27) Something else (3) St/cnty/loc govt\n2   <NA>  <NA> (1) Yes  <NA>  <NA> (27) Something else (3) St/cnty/loc govt\n       V3076         V3077  V3078                  V3079    V3080 WGTPERCY\n1 (1) A city (1) Hhld resp (2) No (4) None above schools 1207.963 603.9816\n2 (1) A city (1) Hhld resp (2) No (4) None above schools 1470.257 735.1283\n  V3081 V3082 PER_TIS PERINTVNUM PINTTYPE_TIS1                 PINTTYPE_TIS2\n1     0  2022       5          5          <NA> (1) Personal, Self-respondent\n2     0  2022       6          6          <NA> (1) Personal, Self-respondent\n                   PINTTYPE_TIS3                  PINTTYPE_TIS4\n1 (2) Telephone, Self-respondent (2) Telephone, Self-respondent\n2 (2) Telephone, Self-respondent (2) Telephone, Self-respondent\n                   PINTTYPE_TIS5                 PINTTYPE_TIS6\n1 (2) Telephone, Self-respondent (1) Personal, Self-respondent\n2 (2) Telephone, Self-respondent (1) Personal, Self-respondent\n                   PINTTYPE_TIS7                             PERBOUNDED\n1                           <NA> (1) Bounded by previous time in sample\n2 (2) Telephone, Self-respondent (1) Bounded by previous time in sample\n```\n\n\n:::\n:::\n\n\n\nThese two rows represent two surveys, six months apart of the same divorced, 62-63 year-old, white male. Let's look up another household.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataPers22 |>\n  filter(IDHH==\"1809000284384631568236124\") |>\n  select(!starts_with(\"PERREP\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              V3001  YEARQ                      IDHH\n1 (3) Person record 2022.1 1809000284384631568236124\n2 (3) Person record 2022.1 1809000284384631568236124\n                        IDPER V3002                   V3003 V3004\n1 180900028438463156823612401     5 (221) 2022, 1st quarter    18\n2 180900028438463156823612402     5 (221) 2022, 1st quarter    18\n                 V3005 V3006 V3008 V3009 V3010              V3011\n1 09000284384631568236     1    24     1     1 (2) Telephone/self\n2 09000284384631568236     1    24     2     2   (5) Noninterview\n                  V3012 V3013 V3014       V3015       V3016      V3017\n1 (11) Reference person    69    69 (1) Married (1) Married (2) Female\n2          (01) Husband    60    60 (1) Married (1) Married   (1) Male\n       V3018  V3019                 V3020          V3023A  V3024 V3024A\n1 (2) Female   <NA> (28) High school grad (01) White only (2) No (2) No\n2   (1) Male (2) No (28) High school grad (01) White only (2) No (2) No\n          V3025 V3026 V3027 V3031 V3032 V3033  V3034 V3035  V3040 V3041  V3042\n1 (02) February    18  2022    NA     9    NA (2) No    NA (2) No    NA (2) No\n2          <NA>    NA    NA    NA    NA    NA   <NA>    NA   <NA>    NA   <NA>\n  V3043  V3044 V3045  V3046 V3047  V3048 V3049 V3050 V3051 V3052 V3053  V3054\n1    NA (2) No    NA (2) No    NA (2) No  <NA>  <NA>  <NA>  <NA>    NA (2) No\n2    NA   <NA>    NA   <NA>    NA   <NA>  <NA>  <NA>  <NA>  <NA>    NA   <NA>\n  V3055 V3056 V3057 V3058 V3059                V3060   V3061  V3062  V3063\n1  <NA>  <NA>  <NA>  <NA>    NA (1) At least 1 entry (1) Yes (0) No (0) No\n2  <NA>  <NA>  <NA>  <NA>    NA                 <NA>    <NA>   <NA>   <NA>\n   V3064  V3065  V3066  V3067  V3068               V3069 V3070 V3_V4526H3A\n1 (0) No (0) No (0) No (0) No (0) No (0) No out of range  <NA>     (1) Yes\n2   <NA>   <NA>   <NA>   <NA>   <NA>                <NA>  <NA>        <NA>\n  V3_V4526H3B V3_V4526H5 V3_V4526H4 V3_V4526H6 V3_V4526H7\n1      (2) No     (2) No     (2) No     (2) No     (2) No\n2        <NA>       <NA>       <NA>       <NA>       <NA>\n                               V3083                                     V3084\n1 (1) Yes, born in the United States (2) Straight, that is, not lesbian or gay\n2                               <NA>                                      <NA>\n       V3085      V3086                            V3087 V3088 V3089 V3090\n1 (2) Female (2) Female (1) Never served in the military  <NA>  <NA>  <NA>\n2       <NA>       <NA>                             <NA>  <NA>  <NA>  <NA>\n  V3091 V3092 V3093 V3094 V3097A V3098   V3071 V3072 V3073               V3074\n1  <NA>  <NA>  <NA>  <NA>   <NA>  <NA> (1) Yes  <NA>  <NA> (27) Something else\n2  <NA>  <NA>  <NA>  <NA>   <NA>  <NA>    <NA>  <NA>  <NA>                <NA>\n             V3075          V3076             V3077  V3078\n1 (1) Priv company (3) Rural area     (1) Hhld resp (2) No\n2             <NA>           <NA> (0) Not hhld resp   <NA>\n                   V3079    V3080 WGTPERCY V3081 V3082 PER_TIS PERINTVNUM\n1 (4) None above schools 1070.377 535.1885     0  2022       7          7\n2 (4) None above schools    0.000   0.0000     0  2022       7          6\n                   PINTTYPE_TIS1                  PINTTYPE_TIS2\n1 (2) Telephone, Self-respondent (2) Telephone, Self-respondent\n2           (4) Telephone, Proxy           (4) Telephone, Proxy\n                   PINTTYPE_TIS3                  PINTTYPE_TIS4\n1 (2) Telephone, Self-respondent (2) Telephone, Self-respondent\n2           (4) Telephone, Proxy           (4) Telephone, Proxy\n                   PINTTYPE_TIS5                  PINTTYPE_TIS6\n1 (2) Telephone, Self-respondent (2) Telephone, Self-respondent\n2 (2) Telephone, Self-respondent (2) Telephone, Self-respondent\n                   PINTTYPE_TIS7                             PERBOUNDED\n1 (2) Telephone, Self-respondent (1) Bounded by previous time in sample\n2               (5) Noninterview (1) Bounded by previous time in sample\n```\n\n\n:::\n:::\n\n\n\nThese rows represent two surveys occurring at the same time, one of the reference person, a married white female, and a second survey of her husband.\n\nLet's grab the variable details as we did with the household data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Person file also has list of variable details\nvarsPers <- dataPers22 |>\n   attr(\"variable.labels\") |>\n   data.frame() |>\n   tibble::rownames_to_column() |>\n   setNames(c(\"varname\",\"details\")) |>\n   filter(!grepl(\"^(PERREP|PINTTYPE)\", varname))\nvarsPers\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        varname\n1         V3001\n2         YEARQ\n3          IDHH\n4         IDPER\n5         V3002\n6         V3003\n7         V3004\n8         V3005\n9         V3006\n10        V3008\n11        V3009\n12        V3010\n13        V3011\n14        V3012\n15        V3013\n16        V3014\n17        V3015\n18        V3016\n19        V3017\n20        V3018\n21        V3019\n22        V3020\n23       V3023A\n24        V3024\n25       V3024A\n26        V3025\n27        V3026\n28        V3027\n29        V3031\n30        V3032\n31        V3033\n32        V3034\n33        V3035\n34        V3040\n35        V3041\n36        V3042\n37        V3043\n38        V3044\n39        V3045\n40        V3046\n41        V3047\n42        V3048\n43        V3049\n44        V3050\n45        V3051\n46        V3052\n47        V3053\n48        V3054\n49        V3055\n50        V3056\n51        V3057\n52        V3058\n53        V3059\n54        V3060\n55        V3061\n56        V3062\n57        V3063\n58        V3064\n59        V3065\n60        V3066\n61        V3067\n62        V3068\n63        V3069\n64        V3070\n65  V3_V4526H3A\n66  V3_V4526H3B\n67   V3_V4526H5\n68   V3_V4526H4\n69   V3_V4526H6\n70   V3_V4526H7\n71        V3083\n72        V3084\n73        V3085\n74        V3086\n75        V3087\n76        V3088\n77        V3089\n78        V3090\n79        V3091\n80        V3092\n81        V3093\n82        V3094\n83       V3097A\n84        V3098\n85        V3071\n86        V3072\n87        V3073\n88        V3074\n89        V3075\n90        V3076\n91        V3077\n92        V3078\n93        V3079\n94        V3080\n95     WGTPERCY\n96        V3081\n97        V3082\n98      PER_TIS\n99   PERINTVNUM\n100  PERBOUNDED\n                                                                                             details\n1                                                                                 PERSON RECORD TYPE\n2                                                             YEAR AND QUARTER OF INTERVIEW (YYYY.Q)\n3                                                                             NCVS ID FOR HOUSEHOLDS\n4                                                                                NCVS ID FOR PERSONS\n5                                                              ICPSR HOUSEHOLD IDENTIFICATION NUMBER\n6                                                                    YEAR AND QUARTER IDENTIFICATION\n7                                                                                      SAMPLE NUMBER\n8                                                                           SCRAMBLED CONTROL NUMBER\n9                                                                                   HOUSEHOLD NUMBER\n10                                                                          PANEL AND ROTATION GROUP\n11                                                                            PERSON SEQUENCE NUMBER\n12                                                                                PERSON LINE NUMBER\n13                                                                                 TYPE OF INTERVIEW\n14                                                                  RELATIONSHIP TO REFERENCE PERSON\n15                                                                                    AGE (ORIGINAL)\n16                                                                                   AGE (ALLOCATED)\n17                                                                   MARITAL STATUS (CURRENT SURVEY)\n18                                                                  MARITAL STATUS (PREVIOUS SURVEY)\n19                                                                                    SEX (ORIGINAL)\n20                                                                                   SEX (ALLOCATED)\n21                                                                        NOW AN ARMED FORCES MEMBER\n22                                                                            EDUCATIONAL ATTAINMENT\n23                                                                       RACE RECODE (START 2003 Q1)\n24                                                                                   HISPANIC ORIGIN\n25                                                       HISPANIC ORIGIN (ALLOCATED) (START 2014 Q1)\n26                                                                         MONTH INTERVIEW COMPLETED\n27                                                                           DAY INTERVIEW COMPLETED\n28                                                                          YEAR INTERVIEW COMPLETED\n29                                                                 HOW LONG AT THIS ADDRESS (MONTHS)\n30                                                                  HOW LONG AT THIS ADDRESS (YEARS)\n31                                                              HOW MANY TIMES MOVED IN LAST 5 YEARS\n32                                                                       SOMETHING STOLEN OR ATTEMPT\n33                                                             NO. TIMES SOMETHING STOLEN OR ATTEMPT\n34                                                              ATTACK, THREAT, THEFT: LOCATION CUES\n35                                                                   NO. TIMES ATTACK, LOCATION CUES\n36                                                              ATTACK, THREAT: WEAPON & ATTACK CUES\n37                                                                     NO. TIMES ATTACK, WEAPON CUES\n38                                                            STOLEN, ATTACK, THREAT: OFFENDER KNOWN\n39                                                                  NO. TIMES ATTACK, OFFENDER KNOWN\n40                                                                    FORCED OR COERCED UNWANTED SEX\n41                                                                            NO. TIMES UNWANTED SEX\n42                                                              CALL POLICE TO REPORT SOMETHING ELSE\n43                                                                                    FIRST INCIDENT\n44                                                                                   SECOND INCIDENT\n45                                                                                    THIRD INCIDENT\n46                                                                    CHECK B: ATTACK, THREAT, THEFT\n47                                                                   NO. TIMES ATTACK, THREAT, THEFT\n48                                                              THOUGHT CRIME BUT DIDN'T CALL POLICE\n49                                                                                    FIRST INCIDENT\n50                                                                                   SECOND INCIDENT\n51                                                                                    THIRD INCIDENT\n52                                                                    CHECK C: ATTACK, THREAT, THEFT\n53                                                                   NO. TIMES ATTACK, THREAT, THEFT\n54                                                            LI WHO PRESENT DURING SCREEN QUESTIONS\n55                                                                             C TELEPHONE INTERVIEW\n56                                                               C NO ONE BESIDES RESPONDENT PRESENT\n57                                                                             C RESPONDENT'S SPOUSE\n58                                                                    C HH MEMBER(S) 12+, NOT SPOUSE\n59                                                                           C HH MEMBER(S) UNDER 12\n60                                                                          C NONHOUSEHOLD MEMBER(S)\n61                                                                  C SOMEONE PRESENT, CAN'T SAY WHO\n62                                                              C DON'T KNOW IF SOMEONE ELSE PRESENT\n63                                                                RESIDUE: WHO PRESENT DURING SCREEN\n64                                                                DID SELECTED RESPONDENT HELP PROXY\n65                           ARE YOU DEAF OR DO YOU HAVE SERIOUS DIFFICULTY HEARING? (START 2016 Q3)\n66  ARE YOU BLIND OR DO YOU HAVE SERIOUS DIFFICULTY SEEING EVEN WHEN WEARING GLASSES (START 2016 Q3)\n67                                           DIFFICULT: LEARN, REMEMBER, CONCENTRATE (START 2016 Q3)\n68                                                        LIMITS PHYSICAL ACTIVITIES (START 2016 Q3)\n69                                     DIFFICULT: DRESSING, BATHING, GET AROUND HOME (START 2016 Q3)\n70                                   DIFFICULT: GO OUTSIDE HOME TO SHOP OR DR OFFICE (START 2016 Q3)\n71                                                                CITIZENSHIP STATUS (START 2017 Q1)\n72                                                                SEXUAL ORIENTATION (START 2017 Q1)\n73                                                          GENDER IDENTITY AT BIRTH (START 2017 Q1)\n74                                                           CURRENT GENDER IDENTITY (START 2017 Q1)\n75                                                              SERVE ON ACTIVE DUTY (START 2017 Q1)\n76                                                           LI: WHEN ON ACTIVE DUTY (START 2017 Q1)\n77                                                     C ACTIVE DUTY: SEPTEMBER 2001 (START 2017 Q1)\n78                                         C ACTIVE DUTY: AUGUST 1990 TO AUGUST 2001 (START 2017 Q1)\n79                                              C ACTIVE DUTY: MAY 1975 TO JULY 1990 (START 2017 Q1)\n80                            C ACTIVE DUTY: VIETNAM ERA (AUGUST 1964 TO APRIL 1975) (START 2017 Q1)\n81                                         C ACTIVE DUTY: FEBRUARY 1955 TO JULY 1964 (START 2017 Q1)\n82                             C ACTIVE DUTY: KOREAN WAR (JULY 1950 TO JANUARY 1955) (START 2017 Q1)\n83                                                  C ACTIVE DUTY: DISCLOSURE RECODE (START 2022 Q1)\n84                                                              RESIDUE: ACTIVE DUTY (START 2017 Q1)\n85                                                                        HAVE JOB OR WORK LAST WEEK\n86                                                                 HAVE JOB OR WORK IN LAST 6 MONTHS\n87                                                                 DID JOB/WORK LAST 2 WEEKS OR MORE\n88                                                                     WHICH BEST DESCRIBES YOUR JOB\n89                                                               IS EMPLOYMENT PRIVATE, GOVT OR SELF\n90                                                             IS WORK MOSTLY IN CITY, SUBURB, RURAL\n91                                                                              HOUSEHOLD RESPONDENT\n92                                                               EMPLOYED BY A COLLEGE OR UNIVERSITY\n93                                                                                  ATTENDING SCHOOL\n94                                                                                     PERSON WEIGHT\n95                                                          ADJUSTED PERSON WEIGHT - COLLECTION YEAR\n96                                                                  NUMBER OF CRIME INCIDENT REPORTS\n97                                                               YEAR IDENTIFICATION (START 1999 Q3)\n98                                                             PERSON TIME IN SAMPLE (START 2015 Q1)\n99                                                           PERSON INTERVIEW NUMBER (START 2015 Q1)\n100                                        PERSON BOUNDED BY PREVIOUS TIME IN SAMPLE (START 2015 Q1)\n```\n\n\n:::\n:::\n\n\n\n\nThere is an incident-level file that we will read in here. We are not going to look at it further, since much of the information in this file is also in the incident extract file.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nload(\"NCVS2022/DS0004/38603-0004-Data.rda\")\nload(\"NCVS2023/DS0004/38962-0004-Data.rda\")\ndataInc22 <- da38603.0004\ndataInc23 <- da38962.0004\n\ndataInc22 |>\n   select(IDHH, IDPER, V4014, V4529) |> \n   head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                       IDHH                       IDPER          V4014\n1 1809010265731899564536114 180901026573189956453611401  (12) December\n2 1809040225522254568236115 180904022552225456823611501  (11) November\n3 1809213903398449563644234 180921390339844956364423401 (09) September\n4 1809240299163750563236135 180924029916375056323613501 (09) September\n5 1809243565469154563238115 180924356546915456323811501  (12) December\n6 1809243958169129563244125 180924395816912956324412501    (08) August\n                 V4529\n1 (31) Burg, force ent\n2  (56) Theft $50-$249\n3  (56) Theft $50-$249\n4  (56) Theft $50-$249\n5  (58) Theft value NA\n6 (20) Verbal thr aslt\n```\n\n\n:::\n:::\n\n\n\n\nFinally, we will load in the incident extract file and its associated variable details. This extract file merges in household-level and person-level information to the incident-level file, allowing you to connect person-level features with features of the victimizations they report.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# incident-level extract file\nload(\"NCVS2022/DS0005/38603-0005-Data.rda\")\nload(\"NCVS2023/DS0005/38962-0005-Data.rda\")\ndataExt22 <- da38603.0005\ndataExt23 <- da38962.0005\n\nvarsExt <- dataExt22 |>\n   attr(\"variable.labels\") |>\n   data.frame() |>\n   tibble::rownames_to_column() |>\n   setNames(c(\"varname\",\"details\")) |>\n   filter(!grepl(\"INCREPWGT|VICREPWGT\", varname))\n```\n:::\n\n\n\n\nLet's take a look at a few of the reported crime victimizations. Here I will just pull the respondent's age, marital status, sex, general location, and crime type.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataExt22 |>\n  select(V3014, V3015, V3018, V4022, V4529) |>\n  slice(1:3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  V3014        V3015      V3018             V4022                V4529\n1    56 (3) Divorced (2) Female (3) Same city etc (31) Burg, force ent\n2    78  (2) Widowed (2) Female (3) Same city etc  (56) Theft $50-$249\n3    43  (1) Married   (1) Male (3) Same city etc  (56) Theft $50-$249\n```\n\n\n:::\n:::\n\n\n\nNot all information from the household and person files are in the extract file, but many of the features that are likely to be of interest are there.\n\nNow that the datasets are loaded and renamed, we can remove objects from our working environment that we no longer need. We can use `rm()` to accomplish this.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrm(da38603.0002,da38603.0003,da38603.0004,da38603.0005,\n   da38962.0002,da38962.0003,da38962.0004,da38962.0005)\n```\n:::\n\n\n\n\n# Combining 2022 and 2023 data\n\nHere we are going to create a data frame containing all the reported incidents that *occurred* in 2022.\nTake a look at the month and year of the reported crime incidents.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataExt22 |> count(V4015, V4014)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   V4015          V4014   n\n1   2021      (07) July 138\n2   2021    (08) August 280\n3   2021 (09) September 384\n4   2021   (10) October 510\n5   2021  (11) November 650\n6   2021  (12) December 849\n7   2022   (01) January 772\n8   2022  (02) February 727\n9   2022     (03) March 774\n10  2022     (04) April 730\n11  2022       (05) May 770\n12  2022      (06) June 839\n13  2022      (07) July 718\n14  2022    (08) August 593\n15  2022 (09) September 383\n16  2022   (10) October 292\n17  2022  (11) November 136\n```\n\n\n:::\n\n```{.r .cell-code}\ndataExt23 |> count(V4015, V4014)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   V4015          V4014   n\n1   2022      (07) July 175\n2   2022    (08) August 253\n3   2022 (09) September 364\n4   2022   (10) October 524\n5   2022  (11) November 674\n6   2022  (12) December 859\n7   2023   (01) January 753\n8   2023  (02) February 681\n9   2023     (03) March 699\n10  2023     (04) April 688\n11  2023       (05) May 738\n12  2023      (06) June 760\n13  2023      (07) July 721\n14  2023    (08) August 573\n15  2023 (09) September 447\n16  2023   (10) October 273\n17  2023  (11) November 142\n```\n\n\n:::\n:::\n\n\n\nNote that the 2022 NCVS reports on crimes that occurred in 2022 and 2021. Similarly, the NCVS 2023 reports on crimes that occurred in 2023 and 2022. Remember that the NCVS surveys as respondents about any victimizations from the prior 12 months. We will going to stack the 2022 and 2023 incident extract data frames and then filter it to exclude 2021 and 2023.\n\n`bind_rows()` stacks data frames on top of each other, useful when combining two datasets that have the same structure. First we will check that they have the same columns in them.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nidentical(names(dataExt22), names(dataExt23))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n:::\n\n\n\nGood so far! Now let's try to stack them.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataExt <- dataExt22 |>\n  bind_rows(dataExt23)\n```\n\n::: {.cell-output .cell-output-error}\n\n```\nError in `bind_rows()`:\n! Can't combine `..1$V2061` <factor<f6015>> and `..2$V2061` <double>.\n```\n\n\n:::\n:::\n\n\n\nHmmm... R is complaining about `V2061`. Note that it specifically complains that one data frame has `V2061` stored as a factor (a categorical variable) and the other one has it stored as a double, a decimal number.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataExt22 |> count(V2061)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   V2061    n\n1 (01) 1    8\n2   <NA> 9537\n```\n\n\n:::\n\n```{.r .cell-code}\ndataExt23 |> count(V2061)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  V2061    n\n1     1   14\n2     3    1\n3     4    3\n4    NA 9306\n```\n\n\n:::\n:::\n\n\n\nWhat is `V2061` anyway?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvarsExt |> filter(varname==\"V2061\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  varname                          details\n1   V2061 LINE NO. OF 4TH PROXY RESPONDENT\n```\n\n\n:::\n:::\n\n\n\nThis reports on who reported on behalf of an unavailable respondent. Not really important for us so let's drop this one by using `select(-V2061)` on both data frames.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataExt <- dataExt22 |>\n  select(-V2061) |>\n  bind_rows(dataExt23 |>\n              select(-V2061))\n```\n\n::: {.cell-output .cell-output-error}\n\n```\nError in `bind_rows()`:\n! Can't combine `..1$V4126` <factor<fb04b>> and `..2$V4126` <double>.\n```\n\n\n:::\n:::\n\n\n\nUghh. Now it is complaining about `V4126`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvarsExt |> filter(varname==\"V4126\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  varname                              details\n1   V4126 WHICH INJURY FROM OTHER WEAPON (3RD)\n```\n\n\n:::\n\n```{.r .cell-code}\ndataExt22 |> count(V4126)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               V4126    n\n1 (10) Bruises, cuts    3\n2               <NA> 9542\n```\n\n\n:::\n\n```{.r .cell-code}\ndataExt23 |> count(V4126)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  V4126    n\n1    NA 9324\n```\n\n\n:::\n:::\n\n\n\nIn the codebook we can find the full question: \"Q.33.3 Which injuries were caused by a weapon OTHER than a gun or knife?\". This seems like a potentially interesting question that I probably do not want to discard. The issue is that no 2023 respondent said there was a third weapon that injured them. In 2022 `V4126` was stored as a factor, but in 2023, since they are all missing, R defaulted to numeric (double). We can fix this by just telling R to convert the 2023 data into a factor.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataExt <- dataExt22 |>\n  select(-V2061) |>\n  bind_rows(dataExt23 |>\n              select(-V2061) |>\n              mutate(V4126=as.factor(V4126)))\n```\n\n::: {.cell-output .cell-output-error}\n\n```\nError in `bind_rows()`:\n! Can't combine `..1$V4313` <factor<514cc>> and `..2$V4313` <double>.\n```\n\n\n:::\n:::\n\n\n\nDammit! Now it is complaining about `V4313`. What is the problem with this one? Again we have a problem with 2022 storing as a factor and 2023 storing as a double.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvarsExt |> filter(varname==\"V4313\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  varname                                 details\n1   V4313 3RD LINE NO. OF OTHER OWNER THEFT ITEMS\n```\n\n\n:::\n\n```{.r .cell-code}\ndataExt22 |> count(V4313)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   V4313    n\n1 (06) 6    2\n2   <NA> 9543\n```\n\n\n:::\n\n```{.r .cell-code}\ndataExt23 |> count(V4313)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  V4313    n\n1     4    1\n2     5    1\n3    NA 9322\n```\n\n\n:::\n:::\n\n\n\nThis column answers \"Besides the respondent, which household member(s) owned the (property/money) the offender tried to take?\" In 2022, the only responses were missing or #6. In 2023, the responses were missing, 4, or 5. These should be numbers since they are supposed to link respondents in the same household affected by the theft. The approach I'll take is to use `case_match()` telling R to change the 2022 \"(006) 6\" response to a regular 6.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataExt <- dataExt22 |>\n  select(-V2061) |>\n  mutate(V4313 = case_match(V4313,\n                            \"(06) 6\" ~ 6,\n                            .default = NA)) |>\n\n  bind_rows(dataExt23 |>\n              select(-V2061) |>\n              mutate(V4126=as.factor(V4126)))\n```\n\n::: {.cell-output .cell-output-error}\n\n```\nError in `bind_rows()`:\n! Can't combine `..1$V4357A` <double> and `..2$V4357A` <factor<758b7>>.\n```\n\n\n:::\n:::\n\n\n\nWill this ever stop?!?!? Another double in one year and factor in another year, this time affecting `V4357A` asking about handguns.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvarsExt |> filter(varname==\"V4357A\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  varname                                      details\n1  V4357A HOW MANY HANDGUNS WERE TAKEN (START 2004 Q1)\n```\n\n\n:::\n\n```{.r .cell-code}\ndataExt22 |> count(V4357A)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  V4357A    n\n1      1   41\n2      2    8\n3      3    3\n4    997    1\n5    998    1\n6     NA 9491\n```\n\n\n:::\n\n```{.r .cell-code}\ndataExt23 |> count(V4357A)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         V4357A    n\n1       (001) 1   48\n2 (998) Residue    1\n3          <NA> 9275\n```\n\n\n:::\n:::\n\n\n\nYou might have seen this word \"Residue\" show up before. For the NCVS, BJS records \"Residue\" when there is a data entry error resulting in an out-of-range code, an incorrect or unusable answer by the respondent, or the absence of an entry for a question that should have been asked. Sometimes you might also see \"Out of universe/blank.\" This happens when a value is outside the range of questions to be answered. For example, \"Received Medical Care for Injury,\" only victims who report being injured are asked whether they received medical care. All other victims skip this question.\n\nI will solve this issue by recoding the 2023 values to numeric values.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataExt <- dataExt22 |>\n  select(-V2061) |>\n  mutate(V4313 = case_match(V4313,\n                            \"(06) 6\" ~ 6,\n                            .default = NA)) |>\n  bind_rows(dataExt23 |>\n              select(-V2061) |>\n              mutate(V4126 = as.factor(V4126),\n                     V4357A = case_match(V4357A,\n                                         \"(001) 1\" ~ 1,\n                                         \"(998) Residue\" ~ 998,\n                                         .default=NA)))\n```\n:::\n\n\n\nSuccess! Now let's check that all is okay now.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataExt |> count(V4126)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               V4126     n\n1 (10) Bruises, cuts     3\n2               <NA> 18866\n```\n\n\n:::\n\n```{.r .cell-code}\ndataExt |> count(V4313)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  V4313     n\n1     4     1\n2     5     1\n3     6     2\n4    NA 18865\n```\n\n\n:::\n\n```{.r .cell-code}\ndataExt |> count(V4357A)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  V4357A     n\n1      1    89\n2      2     8\n3      3     3\n4    997     1\n5    998     2\n6     NA 18766\n```\n\n\n:::\n:::\n\n\n\n\nRemember that we still have data in here from 2021 and 2023.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(dataExt$V4015)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n2021 2022 2023 \n2811 9583 6475 \n```\n\n\n:::\n:::\n\n\n\nWe are just going to focus on 2022.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataExt <- dataExt |> filter(V4015==2022)\n```\n:::\n\n\n\nNote that BJS official reports generally classify by the year of the survey and not by the year of the crime.\n\n# BJS modifications and survey weights\n\nSome respondents report crime victimizations that occurred outside of the United States.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# V4022 - IN WHAT CITY, TOWN, VILLAGE.\ndataExt |> count(V4022)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                V4022    n\n1    (1) Outside U.S.   44\n2 (2) Not in city etc   67\n3   (3) Same city etc 8069\n4   (4) Diff city etc 1354\n5      (5) Don't know   37\n6         (8) Residue   12\n```\n\n\n:::\n:::\n\n\n\nThe BJS convention is to exclude these crimes in official reports (see 2023 User Guide, page 21).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataExt <- dataExt |>\n  filter(is.na(V4022) | V4022!=\"(1) Outside U.S.\")\n```\n:::\n\n\n\n\nSome crimes happen in a series. For example, a respondent may report on regular domestic abuse that happened numerous times over the last six months. Each incident of domestic abuse is a victimization, but the BJS convention is to include up to 10 occurrences for crimes reported as a series (2023 User Guide, pages 18-19).\n\nVariable `V4016` records the answer to \"Altogether, how many times did this type of incident happen during the last 6 months?\" and variable `V4019` documents \"Can you (respondent) recall enough details of each incident to distinguish them from each other?\"\n\nNote that the coding of `V4016` has 997 representing \"Don't know\" and 998 representing \"Residue\". These are not counts of victimizations. The logic in the `case_when()` statement below checks for counts between 11 and 996 and sets the value of `V4016` to 10 in that case.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataExt <- dataExt |>\n  mutate(V4016 = case_when(\n    V4019==\"(2) No (is series)\" & V4016>=11 & V4016<=996 ~ 10,\n    V4016 >= 997 ~ NA,\n    .default=V4016))\n```\n:::\n\n\n\n\nThe NCVS sampling design oversamples respondents in places more likely to have crime victimization. This makes the sampling effort more efficient. Otherwise, a purely random sample would contact a lot of people who had no victimization to report. As a result, the raw data from the NCVS do not reflect crime victimization in the United States. We must use the NCVS sampling weights to undo the oversampling of crime victims. \n\nConstructing the sampling weights is a complex process (see the User Guide \"Weights Details\" section starting on Page 22). The NCVS sampling weights adjusts for six factors. From the User Guide:\n\n1.  *Base weight*: The inverse of the national sampling rate for the stratum of that unit (person or household).\n\n2.  *Weighting control*: Adjusts for any sub-sampling due to unexpected events in the field, such as new construction, area segments larger than anticipated, and other deviations from the overall stratum sampling rate.\n\n3.  *Household non-interview adjustment*: Adjusts for nonresponse at the household-level by increasing the weights of interviewed households most similar to households not interviewed in terms of race, MSA status of residence, and urban/suburban/rural status of residence. This inflates the weight value assigned to interviewed households so that they represent themselves and non-interviewed households. The non-interviewed cases are assigned a weight of zero, thereby excluding them from population estimates.\n\n4.  *Within-household non-interveiew adjustment*: Adjusts for non-response at the person-level by increasing the weight of interviewed persons most similar to persons not interviewed in terms of region, age, race, sex, and household composition. The adjustment inflates the weight value assigned to completed interviews, so that they represent themselves and sampled individuals who were not interviewed. The non-interviewed cases are assigned a weight of zero. \n\n5.  *First stage ratio estimates factor*: Adjusts for differences between characteristics of the sample non-self-representing (NSR) primary sampling units (PSUs) and independent measures of the population NSR PSUs. (For self-representing PSUs this factor is set to 1). This factor adjusts for PSU differences on region, MSA status, urban/suburban/rural status, and racial composition.\n\n6.  *Second stage ratio estimate factor*: A post-stratification factor defined for each person to adjust for the difference between weighted counts of persons (using the above five weight components) and independent estimates of the number of persons, within certain age by race by sex categories. These independent estimates are based on the Census population controls adjusted for the undercount.\n\nFortunately for us, the variable `SERIES_WEIGHT` captures all these adjustments and contains the weight that BJS uses for its official reports. It includes the adjustment for capping series crimes at 10.\n\n::: callout-tip\n## Always use the sampling weights\n\nImportantly, every calculation you do with the NCVS must involve the weights. This includes weighted means, weighted percentages, and weighted counts. Even plots and figures should use the weights.\n:::\n\nWhere you would normally compute a sample mean as $\\frac{\\sum x_i}{n}$, the weighted mean is\n$$\n\\frac{\\sum w_ix_i}{\\sum w_i}\n$$\nFor a weighted percentage, total all the weights for respondents with the particular feature divided by the total weight. For some plots there is not an obvious way to accommodate the sampling weights. In those cases we can sample with replacement with probabilities proportional to the sampling weights and plot the sampled points.\n\n# Tabulating victimizations\n\nFirst, we need to be clear about what we are counting. BJS will report on *victimizations* and *incidents*. Victimizations count the number of times a US person was victimized. Incidents count the number of times a crime incident occurred and those incidents could involve multiple victims. BJS reports largely focus on criminal victimizations.\n\nWe can start but just asking the NCVS data how many criminal victimizations there were in 2022. We compute that as the sum of all the weights.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(dataExt$SERIES_WEIGHT)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 20121320\n```\n\n\n:::\n:::\n\n\n\nThis means that the NCVS estimates that there were 20,121,320 criminal victimizations in the United States in 2022.\n\nLet's take a closer look at what kinds of victimization occurred. Note that this code breaks the dataset into groups based on the reported crime type, `V4529`, and computes the total weight associated with each of those crime categories.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataExt |>\n  group_by(V4529) |> # crime type\n  summarize(total = sum(SERIES_WEIGHT)) |>\n  print(n=Inf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 33 x 2\n   V4529                       total\n   <fct>                       <dbl>\n 1 (01) Completed rape       127522.\n 2 (02) Attempted rape        67330.\n 3 (03) Sex aslt w s aslt     27038.\n 4 (04) Sex aslt w m aslt      7511.\n 5 (05) Rob w inj s aslt      87026.\n 6 (06) Rob w inj m aslt      88620.\n 7 (07) Rob wo injury        216589.\n 8 (08) At rob inj s asl      25197.\n 9 (09) At rob inj m asl      47896.\n10 (10) At rob w aslt        119279.\n11 (11) Ag aslt w injury     449842.\n12 (12) At ag aslt w wea     397249.\n13 (13) Thr aslt w weap      637952.\n14 (14) Simp aslt w inj      578068.\n15 (15) Sex aslt wo inj      118078.\n16 (16) Unw sex wo force      52425.\n17 (17) Asl wo weap, wo inj 1295757.\n18 (18) Verbal thr rape       41862.\n19 (19) Ver thr sex aslt      15501.\n20 (20) Verbal thr aslt     1978623.\n21 (21) Purse snatching       35375.\n22 (23) Pocket picking       124503.\n23 (31) Burg, force ent      549203.\n24 (32) Burg, ent wo for    1074214.\n25 (33) Att force entry      312530.\n26 (40) Motor veh theft      518797.\n27 (41) At mtr veh theft     193058.\n28 (54) Theft < $10          623035.\n29 (55) Theft $10-$49       1735619.\n30 (56) Theft $50-$249      2968819.\n31 (57) Theft $250+         3057945.\n32 (58) Theft value NA      1799273.\n33 (59) Attempted theft      749585.\n```\n\n\n:::\n:::\n\n\n\nThe first 20 crime types listed are the violent crimes and the remainder are property crimes. Let's extract the two-digit code between the parentheses so that we can classify crime types as violent or property. First, I will run a little test code to make sure my regular expression and the crime type classification works correctly.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataExt |>\n   mutate(crimeCode = gsub(\".([0-9][0-9]).*\", \"\\\\1\", V4529),\n          crimeType = ifelse(crimeCode <= 20, \"violent\", \"property\")) |>\n   select(V4529, crimeCode, crimeType) |>\n   head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  V4529 crimeCode crimeType\n1 (41) At mtr veh theft        41  property\n2  (59) Attempted theft        59  property\n3   (58) Theft value NA        58  property\n4      (57) Theft $250+        57  property\n5    (55) Theft $10-$49        55  property\n6    (07) Rob wo injury        07   violent\n```\n\n\n:::\n:::\n\n\n\nThat all looks correct, so now I can move on to the tabulation.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\na <- dataExt |>\n   mutate(crimeCode = gsub(\".([0-9][0-9]).*\", \"\\\\1\", V4529),\n          crimeType = ifelse(crimeCode <= 20, \"violent\", \"property\")) |>\n   group_by(crimeType) |>\n   summarize(estTotal = sum(SERIES_WEIGHT))\na\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 x 2\n  crimeType  estTotal\n  <chr>         <dbl>\n1 property  13741956.\n2 violent    6379364.\n```\n\n\n:::\n:::\n\n\n\nIn 2022, there was an estimated 6,379,364 violent crimes and 13,741,956 property crimes.\n\nWe can summarize other categories, like car thefts, attempted and completed.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataExt |>\n  filter(V4529 %in% c(\"(40) Motor veh theft\",\n                      \"(41) At mtr veh theft\")) |>\n  summarize(sum(SERIES_WEIGHT))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  sum(SERIES_WEIGHT)\n1           711855.4\n```\n\n\n:::\n:::\n\n\n\n\nMeasuring sexual assault has been complicated by numerous, sometimes major, changes (improvements, more precisely) in the definitions and data collection methods (e.g. question wording). The Uniform Crime Report made a major change to the the [definition of rape changed](https://le.fbi.gov/cjis-division/cjis-link/ucr-program-changes-definition-of-rape) in 2013. The NCVS's most recent change was in 2024. See @FisherGross2025 for an extended discussion and timeline of the changes.\n\nHere is the NCVS estimate of the number of sexual assaults (attempted and completed) for 2022.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataExt |>\n  filter(V4529 %in% c(\"(01) Completed rape\",\n                      \"(02) Attempted rape\")) |>\n  summarize(sum(SERIES_WEIGHT))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  sum(SERIES_WEIGHT)\n1           194852.7\n```\n\n\n:::\n:::\n\n\n\n\nNCVS official reports combine all rape and sexual assaults. There are a lot of crime categories that describe sexual assaults.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunique(dataExt$V4529)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] (41) At mtr veh theft    (59) Attempted theft     (58) Theft value NA     \n [4] (57) Theft $250+         (55) Theft $10-$49       (07) Rob wo injury      \n [7] (13) Thr aslt w weap     (17) Asl wo weap, wo inj (20) Verbal thr aslt    \n[10] (32) Burg, ent wo for    (56) Theft $50-$249      (14) Simp aslt w inj    \n[13] (54) Theft < $10         (31) Burg, force ent     (19) Ver thr sex aslt   \n[16] (23) Pocket picking      (10) At rob w aslt       (11) Ag aslt w injury   \n[19] (40) Motor veh theft     (33) Att force entry     (12) At ag aslt w wea   \n[22] (04) Sex aslt w m aslt   (21) Purse snatching     (03) Sex aslt w s aslt  \n[25] (16) Unw sex wo force    (09) At rob inj m asl    (02) Attempted rape     \n[28] (06) Rob w inj m aslt    (15) Sex aslt wo inj     (18) Verbal thr rape    \n[31] (01) Completed rape      (08) At rob inj s asl    (05) Rob w inj s aslt   \n34 Levels: (01) Completed rape (02) Attempted rape ... (59) Attempted theft\n```\n\n\n:::\n:::\n\n\n\nLet's count any that have the word \"rape\" and any that have the word \"sex\" (sometimes capitalized). Here are the ones that BJS counts in this category.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataExt |>\n  filter(grepl(\"rape|[Ss]ex\", V4529)) |>\n  distinct(V4529)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                   V4529\n1  (19) Ver thr sex aslt\n2 (04) Sex aslt w m aslt\n3 (03) Sex aslt w s aslt\n4  (16) Unw sex wo force\n5    (02) Attempted rape\n6   (15) Sex aslt wo inj\n7   (18) Verbal thr rape\n8    (01) Completed rape\n```\n\n\n:::\n:::\n\n\n\nThe estimated number of all sexual assaults in 2022 in the United States is\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataExt |>\n  filter(grepl(\"rape|[Ss]ex\", V4529)) |>\n  summarize(sum(SERIES_WEIGHT))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  sum(SERIES_WEIGHT)\n1             457268\n```\n\n\n:::\n:::\n\n\n\nSince 2019 we have had no national crime estimates based on police reports.  \n\n# Calculating victimization by demographics\n\nIn the remainder of these notes, we will examine relationships between victimization and the respondents' features, like age (`V3014`), marital status (`V3015`), and sex (`V3018`). To make the code more clear, let's give these variables more intelligible names.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataExt <- dataExt |>\n  rename(age=V3014, marital=V3015, sex=V3018)\n```\n:::\n\n\n\nPerhaps we are interested in which crimes disproportionately affect men and which disproportionately affect women. Start by tabulating crime type by sex.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataExt |>\n  group_by(V4529, sex) |>\n  summarize(count=sum(SERIES_WEIGHT)) |>\n   print(n=Inf)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'V4529'. You can override using the\n`.groups` argument.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 65 x 3\n# Groups:   V4529 [33]\n   V4529                    sex           count\n   <fct>                    <fct>         <dbl>\n 1 (01) Completed rape      (1) Male     18080.\n 2 (01) Completed rape      (2) Female  109442.\n 3 (02) Attempted rape      (1) Male      2190.\n 4 (02) Attempted rape      (2) Female   65140.\n 5 (03) Sex aslt w s aslt   (2) Female   27038.\n 6 (04) Sex aslt w m aslt   (1) Male       677.\n 7 (04) Sex aslt w m aslt   (2) Female    6834.\n 8 (05) Rob w inj s aslt    (1) Male     52000.\n 9 (05) Rob w inj s aslt    (2) Female   35026.\n10 (06) Rob w inj m aslt    (1) Male     16581.\n11 (06) Rob w inj m aslt    (2) Female   72039.\n12 (07) Rob wo injury       (1) Male    102379.\n13 (07) Rob wo injury       (2) Female  114209.\n14 (08) At rob inj s asl    (1) Male     16131.\n15 (08) At rob inj s asl    (2) Female    9065.\n16 (09) At rob inj m asl    (1) Male     31641.\n17 (09) At rob inj m asl    (2) Female   16255.\n18 (10) At rob w aslt       (1) Male     57154.\n19 (10) At rob w aslt       (2) Female   62125.\n20 (11) Ag aslt w injury    (1) Male    195301.\n21 (11) Ag aslt w injury    (2) Female  254541.\n22 (12) At ag aslt w wea    (1) Male    189557.\n23 (12) At ag aslt w wea    (2) Female  207692.\n24 (13) Thr aslt w weap     (1) Male    402951.\n25 (13) Thr aslt w weap     (2) Female  235001.\n26 (14) Simp aslt w inj     (1) Male    214975.\n27 (14) Simp aslt w inj     (2) Female  363093.\n28 (15) Sex aslt wo inj     (1) Male     22433.\n29 (15) Sex aslt wo inj     (2) Female   95645.\n30 (16) Unw sex wo force    (1) Male      7980.\n31 (16) Unw sex wo force    (2) Female   44446.\n32 (17) Asl wo weap, wo inj (1) Male    648373.\n33 (17) Asl wo weap, wo inj (2) Female  647384.\n34 (18) Verbal thr rape     (1) Male     15134.\n35 (18) Verbal thr rape     (2) Female   26727.\n36 (19) Ver thr sex aslt    (1) Male      5480.\n37 (19) Ver thr sex aslt    (2) Female   10021.\n38 (20) Verbal thr aslt     (1) Male   1021068.\n39 (20) Verbal thr aslt     (2) Female  957555.\n40 (21) Purse snatching     (1) Male      1947.\n41 (21) Purse snatching     (2) Female   33428.\n42 (23) Pocket picking      (1) Male     92254.\n43 (23) Pocket picking      (2) Female   32249.\n44 (31) Burg, force ent     (1) Male    177579.\n45 (31) Burg, force ent     (2) Female  371623.\n46 (32) Burg, ent wo for    (1) Male    467653.\n47 (32) Burg, ent wo for    (2) Female  606561.\n48 (33) Att force entry     (1) Male    140494.\n49 (33) Att force entry     (2) Female  172036.\n50 (40) Motor veh theft     (1) Male    249986.\n51 (40) Motor veh theft     (2) Female  268811.\n52 (41) At mtr veh theft    (1) Male     91918.\n53 (41) At mtr veh theft    (2) Female  101140.\n54 (54) Theft < $10         (1) Male    255762.\n55 (54) Theft < $10         (2) Female  367273.\n56 (55) Theft $10-$49       (1) Male    820707.\n57 (55) Theft $10-$49       (2) Female  914912.\n58 (56) Theft $50-$249      (1) Male   1377060.\n59 (56) Theft $50-$249      (2) Female 1591759.\n60 (57) Theft $250+         (1) Male   1649266.\n61 (57) Theft $250+         (2) Female 1408679.\n62 (58) Theft value NA      (1) Male    809339.\n63 (58) Theft value NA      (2) Female  989933.\n64 (59) Attempted theft     (1) Male    400789.\n65 (59) Attempted theft     (2) Female  348795.\n```\n\n\n:::\n:::\n\n\n\nR produces a long narrow table. This format is sometimes useful, particularly when merging data frames. However, in this case having a table with counts for men and women side-by-side would be easier to absorb. `pivot_wider()` will swing the sex column into two side-by-side columns. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataExt |>\n  group_by(V4529, sex) |>\n  summarize(count=sum(SERIES_WEIGHT)) |>\n  pivot_wider(names_from=sex,\n              values_from=count,\n              values_fill = 0) |> # fill in NAs with 0\n  print(n=Inf)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'V4529'. You can override using the\n`.groups` argument.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 33 x 3\n# Groups:   V4529 [33]\n   V4529                    `(1) Male` `(2) Female`\n   <fct>                         <dbl>        <dbl>\n 1 (01) Completed rape          18080.      109442.\n 2 (02) Attempted rape           2190.       65140.\n 3 (03) Sex aslt w s aslt           0        27038.\n 4 (04) Sex aslt w m aslt         677.        6834.\n 5 (05) Rob w inj s aslt        52000.       35026.\n 6 (06) Rob w inj m aslt        16581.       72039.\n 7 (07) Rob wo injury          102379.      114209.\n 8 (08) At rob inj s asl        16131.        9065.\n 9 (09) At rob inj m asl        31641.       16255.\n10 (10) At rob w aslt           57154.       62125.\n11 (11) Ag aslt w injury       195301.      254541.\n12 (12) At ag aslt w wea       189557.      207692.\n13 (13) Thr aslt w weap        402951.      235001.\n14 (14) Simp aslt w inj        214975.      363093.\n15 (15) Sex aslt wo inj         22433.       95645.\n16 (16) Unw sex wo force         7980.       44446.\n17 (17) Asl wo weap, wo inj    648373.      647384.\n18 (18) Verbal thr rape         15134.       26727.\n19 (19) Ver thr sex aslt         5480.       10021.\n20 (20) Verbal thr aslt       1021068.      957555.\n21 (21) Purse snatching          1947.       33428.\n22 (23) Pocket picking          92254.       32249.\n23 (31) Burg, force ent        177579.      371623.\n24 (32) Burg, ent wo for       467653.      606561.\n25 (33) Att force entry        140494.      172036.\n26 (40) Motor veh theft        249986.      268811.\n27 (41) At mtr veh theft        91918.      101140.\n28 (54) Theft < $10            255762.      367273.\n29 (55) Theft $10-$49          820707.      914912.\n30 (56) Theft $50-$249        1377060.     1591759.\n31 (57) Theft $250+           1649266.     1408679.\n32 (58) Theft value NA         809339.      989933.\n33 (59) Attempted theft        400789.      348795.\n```\n\n\n:::\n:::\n\n\n\nLastly, let's normalize the columns so that they add up to 100\\%, giving us the distribution of crime types within each sex.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataExt |>\n  group_by(V4529, sex) |>\n  summarize(count=sum(SERIES_WEIGHT)) |>\n  ungroup() |>  # without this, percentages are computed within crime type\n  pivot_wider(names_from  = sex,\n              values_from = count,\n              values_fill = 0) |>\n  rename(male=`(1) Male`, female=`(2) Female`) |>\n  mutate(male  =100*male/sum(male),\n         female=100*female/sum(female),\n         ratio=female/male) |>\n  arrange(desc(ratio)) |>\n  print(n=Inf)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'V4529'. You can override using the\n`.groups` argument.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 33 x 4\n   V4529                        male  female   ratio\n   <fct>                       <dbl>   <dbl>   <dbl>\n 1 (03) Sex aslt w s aslt    0        0.256  Inf    \n 2 (02) Attempted rape       0.0229   0.616   26.9  \n 3 (21) Purse snatching      0.0204   0.316   15.5  \n 4 (04) Sex aslt w m aslt    0.00709  0.0647   9.12 \n 5 (01) Completed rape       0.189    1.04     5.47 \n 6 (16) Unw sex wo force     0.0835   0.421    5.04 \n 7 (06) Rob w inj m aslt     0.174    0.682    3.93 \n 8 (15) Sex aslt wo inj      0.235    0.905    3.86 \n 9 (31) Burg, force ent      1.86     3.52     1.89 \n10 (19) Ver thr sex aslt     0.0574   0.0948   1.65 \n11 (18) Verbal thr rape      0.158    0.253    1.60 \n12 (14) Simp aslt w inj      2.25     3.44     1.53 \n13 (54) Theft < $10          2.68     3.48     1.30 \n14 (11) Ag aslt w injury     2.04     2.41     1.18 \n15 (32) Burg, ent wo for     4.89     5.74     1.17 \n16 (33) Att force entry      1.47     1.63     1.11 \n17 (58) Theft value NA       8.47     9.37     1.11 \n18 (56) Theft $50-$249      14.4     15.1      1.05 \n19 (07) Rob wo injury        1.07     1.08     1.01 \n20 (55) Theft $10-$49        8.59     8.66     1.01 \n21 (41) At mtr veh theft     0.962    0.957    0.995\n22 (12) At ag aslt w wea     1.98     1.97     0.991\n23 (10) At rob w aslt        0.598    0.588    0.983\n24 (40) Motor veh theft      2.62     2.54     0.972\n25 (17) Asl wo weap, wo inj  6.79     6.13     0.903\n26 (20) Verbal thr aslt     10.7      9.06     0.848\n27 (59) Attempted theft      4.19     3.30     0.787\n28 (57) Theft $250+         17.3     13.3      0.772\n29 (05) Rob w inj s aslt     0.544    0.331    0.609\n30 (13) Thr aslt w weap      4.22     2.22     0.527\n31 (08) At rob inj s asl     0.169    0.0858   0.508\n32 (09) At rob inj m asl     0.331    0.154    0.465\n33 (23) Pocket picking       0.966    0.305    0.316\n```\n\n\n:::\n:::\n\n\n\nSexual assaults disproportionately affect women, while pocket picking and attempted robbery involving assaults disproportionately affect men.\n\nThe sequence `group_by()`, `summarize()`, `ungroup()` is so common that there is an alternative way to do the same calculation more compactly with `.by` in `summarize()`. A frequent R error is to use `group_by()`, then forget that the data is still grouped, and continue to do calculations unaware that they are occurring only within groups. The `.by` argument also helps avoid this error.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# can reduce the group_by, summarize, ungroup with .by\ndataExt |>\n  summarize(count=sum(SERIES_WEIGHT),\n            .by = c(V4529, sex)) |> # eliminates group/ungroup\n  pivot_wider(names_from  = sex,\n              values_from = count,\n              values_fill = 0) |>\n  rename(male=`(1) Male`, female=`(2) Female`) |>\n  mutate(male  =100*male/sum(male),\n         female=100*female/sum(female),\n         ratio=female/male) |>\n  arrange(desc(ratio)) |>\n  print(n=Inf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 33 x 4\n   V4529                        male  female   ratio\n   <fct>                       <dbl>   <dbl>   <dbl>\n 1 (03) Sex aslt w s aslt    0        0.256  Inf    \n 2 (02) Attempted rape       0.0229   0.616   26.9  \n 3 (21) Purse snatching      0.0204   0.316   15.5  \n 4 (04) Sex aslt w m aslt    0.00709  0.0647   9.12 \n 5 (01) Completed rape       0.189    1.04     5.47 \n 6 (16) Unw sex wo force     0.0835   0.421    5.04 \n 7 (06) Rob w inj m aslt     0.174    0.682    3.93 \n 8 (15) Sex aslt wo inj      0.235    0.905    3.86 \n 9 (31) Burg, force ent      1.86     3.52     1.89 \n10 (19) Ver thr sex aslt     0.0574   0.0948   1.65 \n11 (18) Verbal thr rape      0.158    0.253    1.60 \n12 (14) Simp aslt w inj      2.25     3.44     1.53 \n13 (54) Theft < $10          2.68     3.48     1.30 \n14 (11) Ag aslt w injury     2.04     2.41     1.18 \n15 (32) Burg, ent wo for     4.89     5.74     1.17 \n16 (33) Att force entry      1.47     1.63     1.11 \n17 (58) Theft value NA       8.47     9.37     1.11 \n18 (56) Theft $50-$249      14.4     15.1      1.05 \n19 (07) Rob wo injury        1.07     1.08     1.01 \n20 (55) Theft $10-$49        8.59     8.66     1.01 \n21 (41) At mtr veh theft     0.962    0.957    0.995\n22 (12) At ag aslt w wea     1.98     1.97     0.991\n23 (10) At rob w aslt        0.598    0.588    0.983\n24 (40) Motor veh theft      2.62     2.54     0.972\n25 (17) Asl wo weap, wo inj  6.79     6.13     0.903\n26 (20) Verbal thr aslt     10.7      9.06     0.848\n27 (59) Attempted theft      4.19     3.30     0.787\n28 (57) Theft $250+         17.3     13.3      0.772\n29 (05) Rob w inj s aslt     0.544    0.331    0.609\n30 (13) Thr aslt w weap      4.22     2.22     0.527\n31 (08) At rob inj s asl     0.169    0.0858   0.508\n32 (09) At rob inj m asl     0.331    0.154    0.465\n33 (23) Pocket picking       0.966    0.305    0.316\n```\n\n\n:::\n:::\n\n\n\n\nWe can do a similar calculation by age. First, let's discretize age into some fixed age bins. Then, we can repeat the same calculation to learn about victimization differences by age. I have sorted the results by the 18-24 age category, but you can change it to your age category if you wish.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# can reduce the group_by, summarize, ungroup with .by\ndataExt |>\n   mutate(ageGroup = \n             cut(age, \n                 breaks = c(0, 17, 24, 34, 49, 64, Inf),\n                 labels = c(\"12-17\",\"18-24\",\"25-34\",\n                            \"35-49\",\"50-64\",\"65+\"))) |>\n   summarize(count=sum(SERIES_WEIGHT),\n             .by = c(V4529, ageGroup)) |>\n   pivot_wider(names_from  = ageGroup,\n               values_from = count,\n               values_fill = 0,\n               names_sort = TRUE) |> # keep age groups ordered\n   # apply the same function to every column, except V4529\n   mutate(across(-V4529, function(x) 100*x/sum(x))) |>\n   arrange(desc(`18-24`)) |> # you can change to your age group\n   print(n=Inf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 33 x 7\n   V4529                    `12-17` `18-24` `25-34` `35-49` `50-64`   `65+`\n   <fct>                      <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n 1 (56) Theft $50-$249        9.31   13.0   16.2    16.1    14.9    12.9   \n 2 (57) Theft $250+           4.04   11.8   16.1    17.7    16.2    14.3   \n 3 (20) Verbal thr aslt      14.2     9.81  10.1     8.65   11.1     7.99  \n 4 (55) Theft $10-$49         4.14    8.81   9.11    8.16    7.48   12.1   \n 5 (58) Theft value NA        4.70    7.41   8.63    8.71   10.6    10.1   \n 6 (17) Asl wo weap, wo inj  23.5     6.29   6.27    7.01    3.88    4.09  \n 7 (13) Thr aslt w weap       3.63    4.74   3.33    3.13    3.01    1.50  \n 8 (32) Burg, ent wo for      0.743   4.25   3.61    5.00    6.36    9.99  \n 9 (12) At ag aslt w wea      4.90    3.56   1.38    1.91    1.73    0.924 \n10 (11) Ag aslt w injury      3.39    3.52   2.29    2.04    2.33    0.648 \n11 (31) Burg, force ent       0.319   3.44   1.63    3.23    3.00    3.33  \n12 (14) Simp aslt w inj       9.17    3.42   3.22    2.11    2.53    1.59  \n13 (59) Attempted theft       1.12    2.93   3.86    3.71    3.91    4.94  \n14 (40) Motor veh theft       0.657   2.62   2.39    2.78    2.75    2.85  \n15 (54) Theft < $10           4.11    2.45   3.74    2.81    2.69    3.54  \n16 (15) Sex aslt wo inj       2.30    1.76   0.432   0.273   0.409   0     \n17 (01) Completed rape        0.202   1.60   1.04    0.516   0.0606  0.340 \n18 (07) Rob wo injury         1.77    1.36   0.992   0.767   1.07    1.31  \n19 (06) Rob w inj m aslt      0.949   1.26   0.878   0.0208  0.0447  0.197 \n20 (02) Attempted rape        0.239   1.10   0.113   0.377   0.214   0.110 \n21 (21) Purse snatching       0       1.04   0       0       0.119   0.126 \n22 (33) Att force entry       0       0.695  1.80    1.56    1.47    2.67  \n23 (10) At rob w aslt         0.595   0.642  0.511   0.458   0.751   0.681 \n24 (23) Pocket picking        1.66    0.432  0.438   0.489   0.543   1.14  \n25 (41) At mtr veh theft      0       0.426  0.880   1.25    1.26    0.883 \n26 (08) At rob inj s asl      0.979   0.397  0.0819  0.0448  0       0     \n27 (16) Unw sex wo force      2.17    0.387  0.120   0       0.246   0.245 \n28 (18) Verbal thr rape       0.128   0.303  0.157   0.185   0.348   0.0321\n29 (05) Rob w inj s aslt      0       0.187  0.399   0.258   0.846   0.525 \n30 (03) Sex aslt w s aslt     0       0.172  0.0642  0       0       0.771 \n31 (09) At rob inj m asl      0.363   0.133  0.120   0.566   0.0915  0.103 \n32 (19) Ver thr sex aslt      0.293   0      0.115   0.0918  0.0167  0.0857\n33 (04) Sex aslt w m aslt     0.418   0      0       0.0421  0.0345  0     \n```\n\n\n:::\n:::\n\n\n\n\nSince we have made many changes to the dataset, I find it useful to save the final version. This way I can simply `load()` the data again later and know that it already has all the edits and changes that I have made.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsave(dataExt, file=\"NCVS2022.RData\", compress=TRUE)\n```\n:::\n",
    "supporting": [
      "04_Working_with_NCVS_data_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}